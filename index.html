<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å®šåˆ¶ç‰™è†å°ç¨‹åº - äº¤äº’æ¼”ç¤º</title>
  <style>
/* å®šåˆ¶ç‰™è†å°ç¨‹åºæ¼”ç¤º - æ ·å¼æ–‡ä»¶ */

:root {
  /* é…è‰²æ–¹æ¡ˆ */
  --primary-color: #4A90E2;
  --secondary-color: #5AC8AF;
  --accent-color: #E63946;
  --price-color: #FF9800;
  --bg-light: #F8F9FA;
  --bg-warm: #F9F3ED;
  --text-dark: #333333;
  --text-medium: #666666;
  --text-light: #999999;
  --border-color: #E0E0E0;

  /* å°ºå¯¸ */
  --safe-padding: 20px;
  --card-radius: 16px;
  --btn-height: 60px;
  --btn-radius: 30px;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB',
    'Microsoft YaHei', sans-serif;
  background-color: var(--bg-light);
  color: var(--text-dark);
  line-height: 1.5;
  -webkit-font-smoothing: antialiased;
}

/* é¡µé¢å®¹å™¨ */
.page {
  display: none;
  min-height: 100vh;
  padding-bottom: 100px;
}

.page.active {
  display: block;
}

/* é¦–é¡µèƒŒæ™¯ */
.page-home {
  background-color: var(--bg-warm);
}

/* å¯¼èˆªæ  */
.nav-bar {
  display: flex;
  align-items: center;
  padding: 15px var(--safe-padding);
  background: white;
  position: sticky;
  top: 0;
  z-index: 100;
}

.back-btn {
  width: 40px;
  height: 40px;
  background: white;
  border: 1px solid var(--border-color);
  border-radius: 20px;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  transition: all 0.3s;
}

.back-btn:hover {
  background: var(--bg-light);
}

.back-btn svg {
  width: 20px;
  height: 20px;
  fill: var(--text-dark);
}

.step-indicator {
  margin-left: auto;
  font-size: 14px;
  color: var(--text-medium);
}

/* æ ‡é¢˜åŒº */
.title-section {
  text-align: center;
  padding: 30px var(--safe-padding);
}

.main-title {
  font-size: 28px;
  font-weight: bold;
  margin-bottom: 10px;
}

.subtitle {
  font-size: 14px;
  color: var(--text-medium);
  line-height: 1.6;
}

/* ä»‹ç»åŒº */
.intro-section {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  color: white;
  padding: 30px var(--safe-padding);
  margin: 0 var(--safe-padding);
  border-radius: var(--card-radius);
}

.intro-title {
  font-size: 24px;
  font-weight: bold;
  margin-bottom: 10px;
}

.intro-text {
  font-size: 14px;
  opacity: 0.9;
  line-height: 1.8;
}

/* é€‰é¡¹åˆ—è¡¨ */
.options-section {
  padding: 20px var(--safe-padding);
}

.section-title {
  font-size: 18px;
  font-weight: bold;
  margin-bottom: 20px;
  text-align: center;
}

.options-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 15px;
}

/* è§„æ ¼å¡ç‰‡ */
.spec-card {
  background: white;
  border-radius: var(--card-radius);
  padding: 20px;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  position: relative;
}

.spec-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
}

.spec-card.selected {
  border-color: var(--secondary-color);
  box-shadow: 0 8px 24px rgba(90, 200, 175, 0.2);
}

.spec-image {
  width: 100%;
  height: 120px;
  background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
  border-radius: 12px;
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 40px;
}

.spec-name {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 5px;
  text-align: center;
}

.spec-desc {
  font-size: 12px;
  color: var(--text-light);
  text-align: center;
  margin-bottom: 5px;
}

.spec-capacity {
  font-size: 14px;
  color: var(--text-medium);
  text-align: center;
  margin-bottom: 10px;
}

.spec-tag {
  display: inline-block;
  background: var(--secondary-color);
  color: white;
  font-size: 12px;
  padding: 4px 12px;
  border-radius: 12px;
  position: absolute;
  top: 10px;
  right: 10px;
}

.spec-price {
  font-size: 18px;
  color: var(--price-color);
  font-weight: bold;
  text-align: center;
  margin-top: 10px;
}

/* æˆåˆ†å¡ç‰‡ */
.ingredient-card {
  background: white;
  border-radius: var(--card-radius);
  padding: 15px;
  cursor: pointer;
  transition: all 0.3s;
  border: 2px solid transparent;
  display: flex;
  gap: 15px;
  position: relative;
}

/* å¤šé€‰æ¨¡å¼çš„å¤é€‰æ¡†æŒ‡ç¤ºå™¨ */
.checkbox-indicator {
  width: 24px;
  height: 24px;
  border: 2px solid var(--border-color);
  border-radius: 50%;
  position: absolute;
  top: 15px;
  right: 15px;
  display: flex;
  align-items: center;
  justify-content: center;
  transition: all 0.3s;
}

.multi-select.selected .checkbox-indicator {
  background: var(--primary-color);
  border-color: var(--primary-color);
}

.multi-select.selected .checkbox-indicator::after {
  content: 'âœ“';
  color: white;
  font-size: 14px;
  font-weight: bold;
}

.ingredient-card:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(0,0,0,0.1);
}

.ingredient-card.selected {
  border-color: var(--primary-color);
  box-shadow: 0 8px 24px rgba(74, 144, 226, 0.2);
}

.ingredient-image {
  width: 80px;
  height: 80px;
  background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
  border-radius: 12px;
  flex-shrink: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 32px;
}

.ingredient-content {
  flex: 1;
}

.ingredient-name {
  font-size: 16px;
  font-weight: bold;
  margin-bottom: 5px;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.ingredient-price {
  color: var(--price-color);
  font-weight: bold;
}

.ingredient-desc {
  font-size: 13px;
  color: var(--text-medium);
  margin-bottom: 8px;
}

.ingredient-pros {
  font-size: 12px;
  color: var(--text-light);
}

.ingredient-cons {
  font-size: 12px;
  color: var(--accent-color);
  margin-top: 4px;
}

/* åº•éƒ¨æŒ‰é’®åŒº */
.footer-action {
  position: fixed;
  bottom: 0;
  left: 0;
  right: 0;
  background: white;
  padding: 20px var(--safe-padding);
  box-shadow: 0 -4px 20px rgba(0,0,0,0.1);
  z-index: 100;
}

.action-btn {
  width: 100%;
  height: var(--btn-height);
  border-radius: var(--btn-radius);
  border: none;
  font-size: 18px;
  font-weight: bold;
  color: white;
  cursor: pointer;
  transition: all 0.3s;
  background: var(--primary-color);
}

.action-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 24px rgba(74, 144, 226, 0.4);
}

.action-btn:disabled {
  background: var(--border-color);
  cursor: not-allowed;
  transform: none;
  box-shadow: none;
}

.action-btn.primary {
  background: var(--primary-color);
}

.action-btn.success {
  background: var(--secondary-color);
}

.action-btn.danger {
  background: var(--accent-color);
  box-shadow: 0 8px 24px rgba(230, 57, 70, 0.4);
}

/* æ€»ç»“é¡µ */
.summary-container {
  padding: 20px var(--safe-padding);
}

.toothpaste-showcase {
  background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  border-radius: var(--card-radius);
  padding: 40px 20px;
  text-align: center;
  margin-bottom: 20px;
}

.toothpaste-tube {
  font-size: 80px;
  margin-bottom: 20px;
}

.summary-title {
  font-size: 24px;
  font-weight: bold;
  color: white;
  margin-bottom: 10px;
}

.summary-subtitle {
  font-size: 14px;
  color: rgba(255,255,255,0.8);
}

.summary-table {
  background: white;
  border-radius: var(--card-radius);
  overflow: hidden;
  margin-bottom: 20px;
}

.summary-tabs {
  display: flex;
  border-bottom: 1px solid var(--border-color);
}

.summary-tab {
  flex: 1;
  padding: 15px;
  text-align: center;
  font-size: 14px;
  color: var(--text-medium);
  cursor: pointer;
  border-bottom: 2px solid transparent;
}

.summary-tab.active {
  color: var(--primary-color);
  border-bottom-color: var(--primary-color);
  font-weight: bold;
}

.summary-row {
  display: flex;
  padding: 15px;
  border-bottom: 1px solid var(--border-color);
}

.summary-row:last-child {
  border-bottom: none;
}

.summary-label {
  flex: 1;
  font-size: 14px;
  color: var(--text-medium);
}

.summary-value {
  flex: 2;
  font-size: 14px;
  font-weight: bold;
}

.summary-price {
  flex: 1;
  text-align: right;
  color: var(--price-color);
  font-weight: bold;
}

.total-section {
  background: white;
  border-radius: var(--card-radius);
  padding: 25px;
  text-align: center;
  margin-bottom: 20px;
}

.total-label {
  font-size: 16px;
  color: var(--text-medium);
  margin-bottom: 10px;
}

.total-price {
  font-size: 48px;
  font-weight: bold;
  color: var(--accent-color);
}

.celebration-text {
  font-size: 14px;
  color: var(--text-light);
  margin-top: 15px;
  line-height: 1.8;
}

/* ä¸‹å•é¡µ */
.order-form {
  padding: 20px var(--safe-padding);
}

.form-group {
  background: white;
  border-radius: var(--card-radius);
  padding: 20px;
  margin-bottom: 15px;
}

.form-label {
  font-size: 14px;
  color: var(--text-medium);
  margin-bottom: 10px;
  display: block;
}

.form-input {
  width: 100%;
  padding: 12px;
  border: 1px solid var(--border-color);
  border-radius: 8px;
  font-size: 14px;
  font-family: inherit;
}

.form-input:focus {
  outline: none;
  border-color: var(--primary-color);
}

.address-display {
  padding: 15px;
  background: var(--bg-light);
  border-radius: 8px;
  margin-bottom: 10px;
}

.address-name {
  font-weight: bold;
  margin-bottom: 5px;
}

.address-phone {
  color: var(--text-medium);
  font-size: 14px;
}

.address-detail {
  color: var(--text-medium);
  font-size: 13px;
  margin-top: 5px;
}

/* å“åº”å¼è®¾è®¡ */
@media (max-width: 480px) {
  :root {
    --safe-padding: 15px;
  }

  .options-grid {
    grid-template-columns: 1fr;
  }

  .main-title {
    font-size: 24px;
  }

  .total-price {
    font-size: 40px;
  }
}

/* åŠ¨ç”»æ•ˆæœ */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.fade-in {
  animation: fadeIn 0.3s ease-out;
}

/* æ»šåŠ¨æ¡æ ·å¼ */
::-webkit-scrollbar {
  width: 6px;
}

::-webkit-scrollbar-track {
  background: var(--bg-light);
}

::-webkit-scrollbar-thumb {
  background: var(--border-color);
  border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
  background: var(--text-light);
}

</style>
</head>
<body>

  <!-- é¦–é¡µ - è§„æ ¼é€‰æ‹© -->
  <div id="home" class="page page-home active">
    <nav class="nav-bar">
      <div class="back-btn" onclick="window.history.back()">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      </div>
    </nav>

    <div class="intro-section">
      <h1 class="intro-title">ä¸“å±é…æ–¹</h1>
      <p class="intro-text">å®šåˆ¶ä½ çš„ä¸“å±ç‰™è†<br>æ¯ä¸€å¤©çš„æŠ¤ç†éƒ½ç‹¬ä¸€æ— äºŒ</p>
    </div>

    <div class="title-section">
      <h2 class="main-title">é€‰æ‹©è§„æ ¼</h2>
      <p class="subtitle">å®¹é‡è§„æ ¼å†³å®šå„ç±»æˆåˆ†çš„ç”¨é‡</p>
    </div>

    <div class="options-section">
      <div id="specOptions" class="options-grid">
        <!-- è§„æ ¼é€‰é¡¹å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <div class="footer-action">
      <button id="homeNextBtn" class="action-btn success" onclick="goToNext()" disabled>é€‰å¥½äº†ï¼Œä¸‹ä¸€æ­¥</button>
    </div>
  </div>

  <!-- æˆåˆ†é€‰æ‹©é¡µï¼ˆé€šç”¨æ¨¡æ¿ï¼‰ -->
  <div id="ingredient" class="page">
    <nav class="nav-bar">
      <div class="back-btn" onclick="goBack()">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      </div>
      <span id="stepIndicator" class="step-indicator">1/6 åŸºåº•ç£¨åˆå‰‚</span>
    </nav>

    <div class="title-section">
      <h2 id="categoryTitle" class="main-title">é€‰æ‹©åŸºåº•ç£¨åˆå‰‚</h2>
      <p id="categoryDesc" class="subtitle">é€‰æ‹©åŸºåº•æˆåˆ†ï¼Œå†³å®šç‰™è†çš„æ‘©æ“¦ç‰¹æ€§å’Œæ¸…æ´åŠ›åº¦ï¼ˆå•é€‰ï¼‰</p>
    </div>

    <div class="options-section">
      <div id="ingredientOptions">
        <!-- æˆåˆ†é€‰é¡¹å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
      </div>
    </div>

    <div class="footer-action">
      <button id="ingredientNextBtn" class="action-btn primary" onclick="goToNext()" disabled>ä¸‹ä¸€æ­¥</button>
    </div>
  </div>

  <!-- æ€»ç»“é¡µ -->
  <div id="summary" class="page">
    <nav class="nav-bar">
      <div class="back-btn" onclick="goBack()">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      </div>
    </nav>

    <div class="summary-container">
      <div class="toothpaste-showcase">
        <div class="toothpaste-tube">ğŸ¦·</div>
        <h2 class="summary-title">æ‚¨çš„ä¸“å±é…æ–¹</h2>
        <p class="summary-subtitle">å·²æ ¹æ®æ‚¨çš„éœ€æ±‚å®šåˆ¶å®Œæˆ</p>
      </div>

      <div class="summary-table">
        <div class="summary-tabs">
          <div class="summary-tab active">é…æ–¹æ€»ç»“</div>
          <div class="summary-tab">è§„æ ¼</div>
          <div class="summary-tab">åŠ ä»·</div>
        </div>
        <div id="summaryBody">
          <!-- é…æ–¹ä¿¡æ¯å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>

      <div class="total-section">
        <div class="total-label">æ€»ä»·</div>
        <div id="totalPrice" class="total-price">Â¥0</div>
        <p class="celebration-text">è¿™æ˜¯ä¸“ä¸ºä½ å®šåˆ¶çš„ç‰™è†<br>æ¯ä¸€å¤©çš„æŠ¤ç†éƒ½ç‹¬ä¸€æ— äºŒ</p>
      </div>
    </div>

    <div class="footer-action">
      <button id="summaryNextBtn" class="action-btn danger" onclick="goToNext()">ç«‹å³ä¸‹å•</button>
    </div>
  </div>

  <!-- ä¸‹å•é¡µ -->
  <div id="order" class="page">
    <nav class="nav-bar">
      <div class="back-btn" onclick="goBack()">
        <svg viewBox="0 0 24 24"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
      </div>
      <span class="step-indicator">ç¡®è®¤è®¢å•</span>
    </nav>

    <div class="title-section">
      <h2 class="main-title">ç¡®è®¤è®¢å•ä¿¡æ¯</h2>
    </div>

    <div class="order-form">
      <div class="form-group">
        <label class="form-label">æ”¶è´§äººå§“å</label>
        <input type="text" id="recipientName" class="form-input" placeholder="è¯·è¾“å…¥æ”¶è´§äººå§“å">
      </div>

      <div class="form-group">
        <label class="form-label">æ‰‹æœºå·ç </label>
        <input type="tel" id="recipientPhone" class="form-input" placeholder="è¯·è¾“å…¥æ‰‹æœºå·ç ">
      </div>

      <div class="form-group">
        <label class="form-label">æ”¶è´§åœ°å€</label>
        <textarea id="recipientAddress" class="form-input" rows="3" placeholder="è¯·è¾“å…¥è¯¦ç»†æ”¶è´§åœ°å€"></textarea>
      </div>

      <div class="form-group">
        <div class="address-display">
          <div class="address-name">æ”¶è´§äººï¼šå¼ ä¸‰</div>
          <div class="address-phone">138****8888</div>
          <div class="address-detail">åŒ—äº¬å¸‚æœé˜³åŒºxxxè¡—é“xxxå·</div>
        </div>
        <label class="form-label" style="margin-top: 10px;">ä½¿ç”¨é»˜è®¤åœ°å€</label>
      </div>

      <div class="summary-table">
        <div class="summary-tabs">
          <div class="summary-tab active">è®¢å•è¯¦æƒ…</div>
        </div>
        <div id="orderSummary">
          <!-- è®¢å•ä¿¡æ¯å°†ç”±JSåŠ¨æ€ç”Ÿæˆ -->
        </div>
      </div>

      <div class="total-section">
        <div class="total-label">æ”¯ä»˜é‡‘é¢</div>
        <div id="orderTotalPrice" class="total-price">Â¥0</div>
      </div>
    </div>

    <div class="footer-action">
      <button class="action-btn danger" onclick="submitOrder()">ç¡®è®¤æ”¯ä»˜</button>
    </div>
  </div>

  <script>
/* å®šåˆ¶ç‰™è†å°ç¨‹åºæ¼”ç¤º - äº¤äº’é€»è¾‘å’Œæ•°æ® */

// è§„æ ¼æ•°æ®
const specData = [
  {
    id: 's1',
    name: 'å°æ ·è£…',
    capacity: '15ml',
    price: 2,
    tag: 'é¦–æ¬¡ä½“éªŒ',
    description: 'é€‚åˆåˆæ¬¡ä½“éªŒ'
  },
  {
    id: 's2',
    name: 'æ ‡å‡†è£…',
    capacity: '60ml',
    price: 2,
    tag: 'æ¨è',
    description: 'é€‚åˆæ—¥å¸¸ä½¿ç”¨'
  },
  {
    id: 's3',
    name: 'å®¶åº­è£…',
    capacity: '120ml',
    price: 1,
    tag: '',
    description: 'é€‚åˆå…¨å®¶ä½¿ç”¨'
  },
  {
    id: 's4',
    name: 'è¶…å¤§è£…',
    capacity: '180ml',
    price: 0,
    tag: '',
    description: 'æ€§ä»·æ¯”ä¹‹é€‰'
  }
];

// æˆåˆ†ç±»åˆ«æ•°æ®
const categoryData = {
  base: {
    title: 'åŸºåº•ç£¨åˆå‰‚',
    description: 'é€‰æ‹©åŸºåº•æˆåˆ†ï¼Œå†³å®šç‰™è†çš„æ‘©æ“¦ç‰¹æ€§å’Œæ¸…æ´åŠ›åº¦',
    options: [
      {
        id: 'b1',
        name: 'æ°´åˆç¡…çŸ³',
        desc: 'ç£¨åˆæ›´æŸ”å’Œã€ä¸æ˜“æŸä¼¤ç‰™é‡‰è´¨',
        price: 5,
        amount: '55ml',
        pros: 'æ¸©å’ŒæŠ¤é½¿ï¼Œé€‚åˆæ•æ„Ÿäººç¾¤',
        cons: 'æ¸…æ´åŠ›ç¨å¼±',
        icon: 'ğŸ¦·'
      },
      {
        id: 'b2',
        name: 'æ°´åˆç¡…çŸ³+ç¢³é…¸é’™',
        desc: 'ç£¨åˆåŠ›æ›´å¼ºï¼Œæ¸…æ´æ›´å½»åº•',
        price: 4,
        amount: '40ml+15ml',
        pros: 'æ¸…æ´åŠ›å¼ºï¼Œå»æ¸æ•ˆæœå¥½',
        cons: 'å¯èƒ½æŸä¼¤ç‰™é½¿',
        icon: 'ğŸ’'
      },
      {
        id: 'b3',
        name: 'ç£·é…¸æ°¢é’™',
        desc: 'æ¸©å’Œæ— åˆºæ¿€ï¼Œé€‚åˆæ•æ„Ÿç‰™äººç¾¤',
        price: 6,
        amount: '55ml',
        pros: 'æå…¶æ¸©å’Œï¼Œæ— åˆºæ¿€',
        cons: 'ä»·æ ¼è¾ƒé«˜',
        icon: 'âœ¨'
      },
      {
        id: 'b4',
        name: 'æ°¢æ°§åŒ–é“',
        desc: 'å…¼å…·æŠ›å…‰æ•ˆæœï¼Œå‡å°‘ç‰™é¢è‰²ç´ æ²‰ç§¯',
        price: 7,
        amount: '55ml',
        pros: 'æŠ›å…‰æ•ˆæœå¥½ï¼Œé˜²è‰²ç´ æ²‰ç§¯',
        cons: 'æˆæœ¬è¾ƒé«˜',
        icon: 'ğŸŒŸ'
      }
    ]
  },
  clean: {
    title: 'æ¸…æ´æ€èŒæ•ˆæœ',
    description: 'é€‰æ‹©æ¸…æ´æ€èŒæˆåˆ†ï¼Œå†³å®šç‰™è†çš„æŠ—èŒå’Œæ¸…æ–°æ•ˆæœ',
    options: [
      {
        id: 'c1',
        name: 'æœˆæ¡‚é…°è‚Œæ°¨é…¸é’ ',
        desc: 'æ¸©å’Œå‘æ³¡ï¼Œæ¸…æ´åŠ›å¼ºä¸”ä¸åˆºæ¿€å£è…”é»è†œ',
        price: 8,
        amount: '1.5%',
        pros: 'æ¸©å’Œä¸åˆºæ¿€ï¼Œæ¸…æ´åŠ›å¼º',
        cons: 'ä»·æ ¼è¾ƒé«˜',
        icon: 'ğŸ«§'
      },
      {
        id: 'c2',
        name: 'æœˆæ¡‚é†‡ç¡«é…¸é…¯é’ ',
        desc: 'èµ·æ³¡ä¸°å¯Œï¼Œæ¸…æ´åŠ›å¼º',
        price: 5,
        amount: '2%',
        pros: 'èµ·æ³¡ä¸°å¯Œï¼Œæ€§ä»·æ¯”é«˜',
        cons: 'å¯èƒ½åˆºæ¿€å£è…”é»è†œ',
        icon: 'ğŸ§´'
      },
      {
        id: 'c3',
        name: 'æ¤°æ²¹é…°èƒºä¸™åŸºç”œèœç¢±',
        desc: 'ä¸¤æ€§è¡¨é¢æ´»æ€§å‰‚ï¼Œæ¸©å’Œæ— åˆºæ¿€',
        price: 10,
        amount: '2%',
        pros: 'æåº¦æ¸©å’Œï¼Œæ•æ„Ÿå£è…”é€‚ç”¨',
        cons: 'æˆæœ¬æœ€é«˜',
        icon: 'ğŸŒ¿'
      },
      {
        id: 'c4',
        name: 'ä¸æ·»åŠ ',
        desc: 'ä»…ä¾é ç‰©ç†æ‘©æ“¦æ¸…æ´ï¼Œæ— åŒ–å­¦ä¹³åŒ–',
        price: 0,
        amount: '-',
        pros: 'æ— åŒ–å­¦æˆåˆ†ï¼Œå¤©ç„¶å®‰å…¨',
        cons: 'æ¸…æ´åŠ›è¾ƒå¼±',
        icon: 'ğŸ’§'
      }
    ]
  },
  antiCavity: {
    title: 'é˜²é¾‹é½¿æ•ˆæœ',
    description: 'é€‰æ‹©é˜²é¾‹é½¿æˆåˆ†ï¼Œå†³å®šç‰™è†çš„é˜²è›€èƒ½åŠ›',
    options: [
      {
        id: 'a1',
        name: 'æ°ŸåŒ–é’ ',
        desc: 'é¢„é˜²é¾‹é½¿çš„é»„é‡‘æˆåˆ†ï¼Œä¿ƒè¿›ç‰™é‡‰è´¨å†çŸ¿åŒ–',
        price: 6,
        amount: '0.24%',
        pros: 'ä¸´åºŠéªŒè¯å……åˆ†ï¼Œé˜²è›€æ•ˆæœå¥½',
        cons: 'å„¿ç«¥éœ€æ§åˆ¶ç”¨é‡',
        icon: 'ğŸ¦ '
      },
      {
        id: 'a2',
        name: 'å•æ°Ÿç£·é…¸é’ ',
        desc: 'é«˜æ•ˆé˜²è›€æˆåˆ†ï¼Œç¨³å®šæ€§å¥½',
        price: 7,
        amount: '0.76%',
        pros: 'é˜²è›€æ•ˆæœå¥½ï¼Œå‰¯ä½œç”¨å°',
        cons: 'æˆæœ¬è¾ƒé«˜',
        icon: 'âš¡'
      },
      {
        id: 'a3',
        name: 'æœ¨ç³–é†‡',
        desc: 'å¤©ç„¶é˜²è›€æˆåˆ†ï¼ŒæŠ‘åˆ¶è‡´é¾‹èŒ',
        price: 8,
        amount: '5%',
        pros: 'å¤©ç„¶å®‰å…¨ï¼Œå„¿ç«¥å¯ç”¨',
        cons: 'é˜²è›€æ•ˆæœç•¥é€Šäºæ°ŸåŒ–ç‰©',
        icon: 'ğŸƒ'
      },
      {
        id: 'a4',
        name: 'ä¸æ·»åŠ ',
        desc: 'æ— é˜²è›€æˆåˆ†ï¼Œä»…ä¾é ç‰©ç†æ¸…æ´',
        price: 0,
        amount: '-',
        pros: 'æ— åŒ–å­¦æˆåˆ†',
        cons: 'é˜²è›€èƒ½åŠ›æœ‰é™',
        icon: 'ğŸš«'
      }
    ]
  },
  whitening: {
    title: 'ç¾ç™½æ•ˆæœ',
    description: 'é€‰æ‹©ç¾ç™½æˆåˆ†ï¼Œå†³å®šç‰™è†çš„ç¾ç™½èƒ½åŠ›',
    options: [
      {
        id: 'w1',
        name: 'æ¤é…¸é’ ',
        desc: 'é€šè¿‡è¯åˆä½œç”¨å»é™¤è‰²ç´ ï¼Œæ¸©å’Œç¾ç™½',
        price: 12,
        amount: '0.5%',
        pros: 'æ¸©å’Œä¸ä¼¤ç‰™é‡‰è´¨',
        cons: 'è§æ•ˆæ…¢ï¼Œéœ€æŒç»­ä½¿ç”¨',
        icon: 'ğŸŒˆ'
      },
      {
        id: 'w2',
        name: 'è¿‡æ°§åŒ–æ°¢',
        desc: 'é€šè¿‡æ°§åŒ–ä½œç”¨åˆ†è§£è‰²ç´ ï¼Œå¿«é€Ÿç¾ç™½',
        price: 15,
        amount: '1%',
        pros: 'è§æ•ˆå¿«',
        cons: 'å¯èƒ½æŸä¼¤ç‰™é‡‰è´¨ï¼Œæ•æ„Ÿç‰™æ…ç”¨',
        icon: 'âš¡'
      },
      {
        id: 'w3',
        name: 'çç ç²‰',
        desc: 'å¤©ç„¶ç¾ç™½æˆåˆ†ï¼Œæ¸©å’Œå»æ¸',
        price: 10,
        amount: '2%',
        pros: 'å¤©ç„¶æˆåˆ†ï¼Œæ¸©å’Œå®‰å…¨',
        cons: 'ç¾ç™½æ•ˆæœè¾ƒæ…¢',
        icon: 'âœ¨'
      },
      {
        id: 'w4',
        name: 'ä¸æ·»åŠ ',
        desc: 'æ— ç¾ç™½æˆåˆ†',
        price: 0,
        amount: '-',
        pros: 'æ— åŒ–å­¦æˆåˆ†',
        cons: 'æ— ç¾ç™½æ•ˆæœ',
        icon: 'ğŸš«'
      }
    ]
  },
  gumCare: {
    title: 'ç‰™é¾ˆæŠ¤ç†æ•ˆæœ',
    description: 'é€‰æ‹©ç‰™é¾ˆæŠ¤ç†æˆåˆ†ï¼Œæ”¹å–„ç‰™é¾ˆå¥åº·',
    options: [
      {
        id: 'g1',
        name: 'ç»´ç”Ÿç´ E',
        desc: 'æ»‹å…»ç‰™é¾ˆï¼Œä¿ƒè¿›ç‰™é¾ˆå¥åº·',
        price: 6,
        amount: '0.5%',
        pros: 'æ»‹å…»ç‰™é¾ˆï¼Œæ”¹å–„çº¢è‚¿',
        cons: 'è§æ•ˆè¾ƒæ…¢',
        icon: 'ğŸ’š'
      },
      {
        id: 'g2',
        name: 'è‰æœ¬ç²¾å',
        desc: 'å¤šç§è‰æœ¬èƒå–ï¼Œèˆ’ç¼“ç‰™é¾ˆä¸é€‚',
        price: 8,
        amount: '1%',
        pros: 'èˆ’ç¼“æ•ˆæœæ˜æ˜¾ï¼Œå¤©ç„¶è‰æœ¬',
        cons: 'å¯èƒ½å¯¹è‰æœ¬æˆåˆ†è¿‡æ•',
        icon: 'ğŸŒ¿'
      },
      {
        id: 'g3',
        name: 'ç›Šç”ŸèŒ',
        desc: 'å¹³è¡¡å£è…”èŒç¾¤ï¼Œæ”¹å–„ç‰™é¾ˆç‚ç—‡',
        price: 10,
        amount: '0.1%',
        pros: 'ä»æ ¹æºæ”¹å–„å£è…”ç¯å¢ƒ',
        cons: 'æˆæœ¬è¾ƒé«˜',
        icon: 'ğŸ¦ '
      },
      {
        id: 'g4',
        name: 'ä¸æ·»åŠ ',
        desc: 'æ— ç‰¹æ®Šç‰™é¾ˆæŠ¤ç†æˆåˆ†',
        price: 0,
        amount: '-',
        pros: 'æ— é¢å¤–æˆåˆ†',
        cons: 'æ— ç‰™é¾ˆæŠ¤ç†æ•ˆæœ',
        icon: 'ğŸš«'
      }
    ]
  },
  flavor: {
    title: 'å£å‘³é€‰æ‹©',
    description: 'é€‰æ‹©ç‰™è†å£å‘³ï¼Œäº«å—åˆ·ç‰™ä½“éªŒ',
    options: [
      {
        id: 'f1',
        name: 'è–„è·å‘³',
        desc: 'ç»å…¸æ¸…æ–°å£å‘³ï¼ŒæŒä¹…ç•™é¦™',
        price: 0,
        amount: 'é€‚é‡',
        pros: 'ç»å…¸å£å‘³ï¼Œæ¥å—åº¦é«˜',
        cons: 'å£å‘³å•ä¸€',
        icon: 'ğŸƒ'
      },
      {
        id: 'f2',
        name: 'æ°´æœå‘³',
        desc: 'é¦™ç”œæ°´æœå‘³ï¼Œé€‚åˆå„¿ç«¥',
        price: 0,
        amount: 'é€‚é‡',
        pros: 'å£æ„Ÿé¦™ç”œï¼Œå„¿ç«¥å–œæ¬¢',
        cons: 'ä¸é€‚åˆé‡åº¦å¸çƒŸäººç¾¤',
        icon: 'ğŸ“'
      },
      {
        id: 'f3',
        name: 'èŒ¶é¦™å‹',
        desc: 'æ¸…é¦™èŒ¶å‘³ï¼Œèˆ’ç¼“æ”¾æ¾',
        price: 2,
        amount: 'é€‚é‡',
        pros: 'æ¸…é¦™å®œäººï¼Œå£æ„Ÿç‹¬ç‰¹',
        cons: 'å£å‘³å°ä¼—',
        icon: 'ğŸµ'
      },
      {
        id: 'f4',
        name: 'æ— å‘³',
        desc: 'æ— é¢å¤–é¦™ç²¾æ·»åŠ ',
        price: 0,
        amount: '-',
        pros: 'æ— é¦™ç²¾ï¼Œé€‚åˆæ•æ„Ÿäººç¾¤',
        cons: 'å£æ„Ÿè¾ƒæ·¡',
        icon: 'ğŸš«'
      }
    ]
  }
};

// å…¨å±€çŠ¶æ€
let currentStep = 'home';
let currentCategory = '';
let selectedSpec = null;
let selections = {
  base: null,
  clean: [],
  antiCavity: [],
  whitening: [],
  gumCare: [],
  flavor: []
};

const categoryOrder = ['base', 'clean', 'antiCavity', 'whitening', 'gumCare', 'flavor'];

// é¡µé¢åˆ‡æ¢
function showPage(pageId, category = '') {
  document.querySelectorAll('.page').forEach(page => {
    page.classList.remove('active');
  });
  const targetPage = document.getElementById(pageId);
  if (targetPage) {
    targetPage.classList.add('active');
    targetPage.classList.add('fade-in');
    setTimeout(() => {
      targetPage.classList.remove('fade-in');
    }, 300);
  }
  currentStep = pageId;
  currentCategory = category;
  window.scrollTo(0, 0);
}

// é€‰æ‹©è§„æ ¼
function selectSpec(specId) {
  selectedSpec = specData.find(s => s.id === specId);
  document.querySelectorAll('.spec-card').forEach(card => {
    card.classList.remove('selected');
    if (card.dataset.id === specId) {
      card.classList.add('selected');
    }
  });
  updateNextButton();
}

// é€‰æ‹©æˆåˆ†ï¼ˆæ”¯æŒå¤šé€‰ï¼‰
function selectIngredient(category, optionId) {
  const option = categoryData[category].options.find(o => o.id === optionId);
  
  if (Array.isArray(selections[category])) {
    // å¤šé€‰æ¨¡å¼ï¼šåˆ‡æ¢é€‰ä¸­/å–æ¶ˆçŠ¶æ€
    const index = selections[category].findIndex(o => o.id === optionId);
    if (index >= 0) {
      selections[category].splice(index, 1);
    } else {
      selections[category].push(option);
    }
  } else {
    // å•é€‰æ¨¡å¼ï¼ˆå¦‚åŸºåº•ï¼‰
    selections[category] = option;
  }
  
  // æ›´æ–°UIæ˜¾ç¤º
  document.querySelectorAll(`.ingredient-card[data-category="${category}"]`).forEach(card => {
    const cardOptionId = card.dataset.id;
    const isSelected = Array.isArray(selections[category]) 
      ? selections[category].some(o => o.id === cardOptionId)
      : selections[category] && selections[category].id === cardOptionId;
    
    if (isSelected) {
      card.classList.add('selected');
    } else {
      card.classList.remove('selected');
    }
  });
  
  updateNextButton();
}

// æ›´æ–°ä¸‹ä¸€æ­¥æŒ‰é’®çŠ¶æ€
function updateNextButton() {
  let btnId = '';
  let canProceed = false;

  if (currentStep === 'home') {
    btnId = 'homeNextBtn';
    canProceed = selectedSpec !== null;
  } else if (currentStep === 'ingredient') {
    btnId = 'ingredientNextBtn';
    const selection = selections[currentCategory];
    if (Array.isArray(selection)) {
      // å¤šé€‰æ¨¡å¼ï¼šè‡³å°‘é€‰æ‹©ä¸€ä¸ªæ‰èƒ½ç»§ç»­
      canProceed = selection.length > 0;
    } else {
      // å•é€‰æ¨¡å¼ï¼šå¿…é¡»é€‰æ‹©ä¸€ä¸ª
      canProceed = selection !== null;
    }
  }

  if (btnId) {
    const btn = document.getElementById(btnId);
    if (btn) {
      btn.disabled = !canProceed;
    }
  }
}

// è®¡ç®—æ€»ä»·
function calculateTotal() {
  let total = selectedSpec ? selectedSpec.price : 0;
  categoryOrder.forEach(category => {
    const selection = selections[category];
    if (Array.isArray(selection)) {
      // å¤šé€‰æ¨¡å¼ï¼šç´¯åŠ æ‰€æœ‰é€‰ä¸­é¡¹çš„ä»·æ ¼
      selection.forEach(item => {
        total += item.price;
      });
    } else if (selection) {
      // å•é€‰æ¨¡å¼ï¼šåªåŠ ä¸€é¡¹
      total += selection.price;
    }
  });
  return total;
}

// è¿›å…¥ä¸‹ä¸€æ­¥
function goToNext() {
  const currentIndex = categoryOrder.indexOf(currentCategory);

  if (currentStep === 'home') {
    showPage('ingredient', 'base');
  } else if (currentStep === 'ingredient' && currentIndex >= 0 && currentIndex < categoryOrder.length - 1) {
    showPage('ingredient', categoryOrder[currentIndex + 1]);
  } else if (currentStep === 'ingredient' && currentIndex === categoryOrder.length - 1) {
    updateSummary();
    showPage('summary');
  } else if (currentStep === 'summary') {
    showPage('order');
  }
}

// è¿”å›ä¸Šä¸€æ­¥
function goBack() {
  if (currentStep === 'home') {
    return;
  }

  const currentIndex = categoryOrder.indexOf(currentCategory);

  if (currentStep === 'ingredient' && currentIndex > 0) {
    showPage('ingredient', categoryOrder[currentIndex - 1]);
  } else if (currentStep === 'ingredient' && currentIndex === 0) {
    showPage('home');
  } else if (currentStep === 'summary') {
    showPage('ingredient', 'flavor');
  } else if (currentStep === 'order') {
    showPage('summary');
  }
}

// æ›´æ–°æ€»ç»“é¡µ
function updateSummary() {
  const summaryBody = document.getElementById('summaryBody');
  if (!summaryBody) return;

  let html = '';

  // è§„æ ¼ä¿¡æ¯
  if (selectedSpec) {
    html += `
      <div class="summary-row">
        <span class="summary-label">è§„æ ¼</span>
        <span class="summary-value">${selectedSpec.name} (${selectedSpec.capacity})</span>
        <span class="summary-price">Â¥${selectedSpec.price}</span>
      </div>
    `;
  }

  // æˆåˆ†ä¿¡æ¯
  categoryOrder.forEach(category => {
    const selection = selections[category];
    if (selection) {
      if (Array.isArray(selection)) {
        // å¤šé€‰æ¨¡å¼ï¼šæ˜¾ç¤ºæ‰€æœ‰é€‰ä¸­é¡¹
        if (selection.length > 0) {
          html += `
            <div class="summary-row">
              <span class="summary-label">${categoryData[category].title}</span>
              <span class="summary-value">
                ${selection.map(item => item.name + (item.amount ? ` (${item.amount})` : '')).join(' + ')}
              </span>
              <span class="summary-price">+Â¥${selection.reduce((sum, item) => sum + item.price, 0)}</span>
            </div>
          `;
        }
      } else {
        // å•é€‰æ¨¡å¼
        html += `
          <div class="summary-row">
            <span class="summary-label">${categoryData[category].title}</span>
            <span class="summary-value">${selection.name} ${selection.amount ? `(${selection.amount})` : ''}</span>
            <span class="summary-price">${selection.price > 0 ? `+Â¥${selection.price}` : '-'}</span>
          </div>
        `;
      }
    }
  });

  summaryBody.innerHTML = html;

  // æ›´æ–°æ€»ä»·
  const totalPrice = calculateTotal();
  document.getElementById('totalPrice').textContent = `Â¥${totalPrice}`;
}

// æäº¤è®¢å•
function submitOrder() {
  const name = document.getElementById('recipientName').value;
  const phone = document.getElementById('recipientPhone').value;
  const address = document.getElementById('recipientAddress').value;

  if (!name || !phone || !address) {
    alert('è¯·å¡«å†™å®Œæ•´çš„æ”¶è´§ä¿¡æ¯');
    return;
  }

  alert('è®¢å•æäº¤æˆåŠŸï¼æ„Ÿè°¢æ‚¨çš„è´­ä¹°ï¼');
  // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„è®¢å•æäº¤é€»è¾‘
}

// æ¸²æŸ“è§„æ ¼é€‰æ‹©é¡µ
function renderSpecPage() {
  const container = document.getElementById('specOptions');
  if (!container) return;

  let html = '';
  specData.forEach(spec => {
    html += `
      <div class="spec-card" data-id="${spec.id}" onclick="selectSpec('${spec.id}')">
        ${spec.tag ? `<span class="spec-tag">${spec.tag}</span>` : ''}
        <div class="spec-image">${spec.id === 's1' ? 'ğŸ§´' : spec.id === 's2' ? 'ğŸ§´' : spec.id === 's3' ? 'ğŸ§´' : 'ğŸ§´'}</div>
        <div class="spec-name">${spec.name}</div>
        <div class="spec-capacity">${spec.capacity}</div>
        <div class="spec-desc">${spec.description}</div>
        <div class="spec-price">Â¥${spec.price}</div>
      </div>
    `;
  });

  container.innerHTML = html;
}

// æ¸²æŸ“æˆåˆ†é€‰æ‹©é¡µ
function renderIngredientPage(category) {
  const container = document.getElementById('ingredientOptions');
  const titleEl = document.getElementById('categoryTitle');
  const descEl = document.getElementById('categoryDesc');
  const indicatorEl = document.getElementById('stepIndicator');

  if (!container || !categoryData[category]) return;

  const data = categoryData[category];
  const stepIndex = categoryOrder.indexOf(category) + 1;
  
  // åˆ¤æ–­æ˜¯å¦ä¸ºå¤šé€‰æ¨¡å¼
  const isMultiSelect = Array.isArray(selections[category]);

  titleEl.textContent = data.title;
  descEl.textContent = data.description + (isMultiSelect ? 'ï¼ˆå¯å¤šé€‰ï¼‰' : 'ï¼ˆå•é€‰ï¼‰');
  indicatorEl.textContent = `${stepIndex}/6 ${data.title}`;

  let html = '';
  data.options.forEach(option => {
    html += `
      <div class="ingredient-card ${isMultiSelect ? 'multi-select' : ''}" data-category="${category}" data-id="${option.id}" onclick="selectIngredient('${category}', '${option.id}')">
        ${isMultiSelect ? '<div class="checkbox-indicator"></div>' : ''}
        <div class="ingredient-image">${option.icon}</div>
        <div class="ingredient-content">
          <div class="ingredient-name">
            ${option.name}
            <span class="ingredient-price">${option.price > 0 ? `+Â¥${option.price}` : 'å…è´¹'}</span>
          </div>
          <div class="ingredient-desc">${option.desc}</div>
          <div class="ingredient-pros">âœ“ ${option.pros}</div>
          ${option.cons ? `<div class="ingredient-cons">âœ— ${option.cons}</div>` : ''}
        </div>
      </div>
    `;
  });

  container.innerHTML = html;
  updateNextButton();
}

// é¡µé¢åˆ‡æ¢äº‹ä»¶ç›‘å¬
function setupPageListeners() {
  // ç›‘å¬é¡µé¢åˆ‡æ¢
  document.querySelectorAll('.page').forEach(page => {
    const observer = new MutationObserver((mutations) => {
      mutations.forEach((mutation) => {
        if (mutation.target.classList.contains('active')) {
          const pageId = mutation.target.id;
          if (pageId === 'home') {
            renderSpecPage();
          } else if (pageId === 'ingredient' && currentCategory) {
            renderIngredientPage(currentCategory);
          } else if (pageId === 'summary') {
            updateSummary();
          } else if (pageId === 'order') {
            updateOrderSummary();
          }
        }
      });
    });
    observer.observe(page, { attributes: true, attributeFilter: ['class'] });
  });
}

// æ›´æ–°è®¢å•æ€»ç»“é¡µ
function updateOrderSummary() {
  const summaryBody = document.getElementById('orderSummary');
  const totalPriceEl = document.getElementById('orderTotalPrice');

  if (!summaryBody || !totalPriceEl) return;

  let html = '';

  // è§„æ ¼ä¿¡æ¯
  if (selectedSpec) {
    html += `
      <div class="summary-row">
        <span class="summary-label">è§„æ ¼</span>
        <span class="summary-value">${selectedSpec.name} (${selectedSpec.capacity})</span>
        <span class="summary-price">Â¥${selectedSpec.price}</span>
      </div>
    `;
  }

  // æˆåˆ†ä¿¡æ¯
  categoryOrder.forEach(category => {
    const selection = selections[category];
    if (selection) {
      if (Array.isArray(selection)) {
        // å¤šé€‰æ¨¡å¼ï¼šæ˜¾ç¤ºæ‰€æœ‰é€‰ä¸­é¡¹
        if (selection.length > 0) {
          html += `
            <div class="summary-row">
              <span class="summary-label">${categoryData[category].title}</span>
              <span class="summary-value">
                ${selection.map(item => item.name).join(' + ')}
              </span>
              <span class="summary-price">+Â¥${selection.reduce((sum, item) => sum + item.price, 0)}</span>
            </div>
          `;
        }
      } else {
        // å•é€‰æ¨¡å¼
        html += `
          <div class="summary-row">
            <span class="summary-label">${categoryData[category].title}</span>
            <span class="summary-value">${selection.name}</span>
            <span class="summary-price">${selection.price > 0 ? `+Â¥${selection.price}` : '-'}</span>
          </div>
        `;
      }
    }
  });

  summaryBody.innerHTML = html;

  // æ›´æ–°æ€»ä»·
  const totalPrice = calculateTotal();
  totalPriceEl.textContent = `Â¥${totalPrice}`;
}

// åˆå§‹åŒ–
document.addEventListener('DOMContentLoaded', function() {
  setupPageListeners();
  showPage('home');
  updateNextButton();
});

</script>
</body>
</html>
